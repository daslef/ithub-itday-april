---
title: Предоставление API
description: API, RESTful API, PostgREST
---

import { Aside, LinkCard, CardGrid, Card } from '@astrojs/starlight/components';

### Цель

На этом этапе тебе предстоит разобраться самому и простыми словами объяснить фронтендерам, по каким адресам и с какими настройками обращаться, чтобы получать или мутировать те или иные данные в таблицах.

### Понятие API

Мы не хотим, чтобы фронтенд работал с нашей базой данных напрямую, ведь тогда чувствительные данными придется делиться с клиентом (браузером), а на фронтендеров ляжет дополнительная нагрузка. 
Обычно бэкенд берет на себя реализацию прослойки в виде `API` - набора открытых и задокументированных методов, доступных извне. 

На сегодняшний день есть несколько популярных подходов к построению `API`, среди которых выделим `REST`, `GraphQL`, `*RPC`.

В данном проекте мы крайне рекомендуем использовать `REST`. Он уже реализован на `Supabase` средствами сервера `PostgREST`, иными словами - тебе не придется вручную прописывать запросы к базе данных. 

### RESTful API

В подходе `RESTful` мы обращаемся к *ресурсам* (таблицам) по их именам, а *действие* задается указанием метода `HTTP-запроса`
- `GET` для чтения
- `PATCH` для обновления 
- `POST` для создания
- `DELETE` для удаления

Обычно `RESTful API` реализуется бэкендерами вручную:
- на этапе моделирования определяются объекты, которые будут представлены как ресурсы,
- настраиваются адреса, по которым выбранные ресурсы будут доступны,
- определяются схемы данных для получения и отправки данных,
- операциям над ресурсами сопоставляются HTTP-методы,
- определяется способ обработки дополнительных настроек,
- настраивается аутентификация и разграничение доступов,
- все обработчики тестируются и документируются,
- проводится оптимизация запросов, защита от DDoS и прочее,
- настраивается мониторинг и логгирование,
- производится развертывание на сервер.

В нашем случае почти все задачи на себя берут `Supabase` и `PostgREST`

### PostgREST

`PostgREST` - открытый веб-сервер, который позволяет превратить любую базу данных, 
хранимую в СУБД `PostgreSQL`, в полноценный `RESTful API`. 
Он написан на языке `Haskell` и распространяется по лицензии MIT.


Философия `PostgREST` в декларативном доступе к данным, где все представления создаются прямо в базе данных,
без дополнительных прослоек ввиде `ORM`. Мотивацией разработчиков было желание уйти от ручного программирования 
типовых операций над таблицами базы данных, так как написание бизнес-логики часто дублирует, игнорирует или 
усложняет структуру базы данных.


`PostgREST` упрощает разработку бэкенда и позволяет объединять, экстрагировать и фильтровать данные через запрос. 
Вместо написания кода в `контроллерах` можно просто назначить разрешения для объектов в базе данных, 
а вместо того чтобы писать многочисленные проверки можно напрямую установить ограничения в базе данных. 

Ниже мы оставили ссылку на официальную документацию `PostgREST`, 
но так как она довольно обширная, важные моменты мы будем 
дублировать в дальнейшем руководстве. 

<Aside type="tip" title="Передай фронтендерам">
Бэкенд уже настроил первых пользователей системы. Фронтенд уже может использовать запрос `GET /employees` для запроса информации по сотрудникам. Помимо этого для любого запроса требуется базовый адрес и настройки доступа. Если вы не передали информацию об `URL` и `API KEY`, сделайте это сейчас.
</Aside>


### Что еще почитать по теме

- [Документация PostgREST](https://postgrest.org/en/v12/)
- [Статья о PostgREST на Хабре](https://habr.com/ru/companies/1cloud/articles/478156/)