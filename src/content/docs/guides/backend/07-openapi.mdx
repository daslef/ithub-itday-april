---
title: Документирование
description: Документирование и тестирование API через Insomnia и OpenAPI
---

import { Aside, LinkCard, CardGrid, Card, Steps } from '@astrojs/starlight/components';

### Цель

На этом этапе мы напишем документацию к ресурсу сотрудников, а далее ты сможешь добавить все остальные требуемые по ТЗ операции.

### Документирование API

**Документация API** - коллекция инструкций, описывающих, как использовать `API`. Она служит справочником, а в идеале - даже выступает в качестве интерактивного учебного пособия. 

Из документации нам понятно, какой перед нами `API`, понятны все операции, понятно, как `API` используется и что вернётся. 
Это экономит огромное количество времени разработке для коммуникации с фронтендерами, разработчиками мобильных приложений, 
с ребятами, которые занимаются клиентами. Более того, через эту страницу можно делать запросы и получать ответы.

Хорошо документированный `API` означает, что разработчики и иные стейкхолдеры могут использовать его эффективно и быстрее достигать бизнес-целей.

Стандартный шаблон документации API включает следующие компоненты:
- описание возможностей API;
- список предоставляемых методов со схемами входных и выходных данных;
- технические детали, включая аргументы и возвращаемые значения, для каждого метода;
- информация о версионировании API с журналом изменений;
- руководство по установке, настройке и использованию;
- руководство по устранению неполадок;
- перечень сопутствующей внешней документации.

### Спецификация OpenAPI

Разумеется, в каждой области знания существуют свои стандарты, и в случае документирования один из лидеров - спецификация `OpenAPI`

`OpenAPI` — это популярный opensource-проект (28k звёзд на GitHub), описывающий спецификацию и поддерживаемый `Linux Foundation Collaborative Project`. 
Спецификация определяет стандартизированное описание для REST API-сервисов, независимо от того, на каком языке программирования они написаны, 
удобна для использования как человеком, так и компьютерной программой, не требует доступа к коду. 

Спецификация может быть двух форматов: 
- `JSON`, который более понятен для машин,
- `YAML`, который чуть более читаем для человека.

Чтобы написать такую спецификацию, есть три подхода:
1. Написать вручную в специальных OpenAPI-редакторах или в типовом редакторе кода,
2. Сгенерировать на основе кода бэкенда,
3. Сгенерировать на основе аннотированных коллекций запросов, созданных в `Postman`, `Insomnia` и прочих.

<Aside type="tip" title="Ближе к практике">Как ты, возможно, догадался, мы будем использовать третий</Aside>

### Инструменты документирования

Документация может быть составлена как вручную, так и автоматизированно. 
Среди средств автоматизации выделим `Swagger UI`, `ReDoc`, `RapiDoc`.

<LinkCard title="API Petstore (Swagger UI)" href="https://petstore.swagger.io/"></LinkCard>
<LinkCard title="API HeadHunter (ReDoc)" href="https://api.hh.ru/openapi/redoc"></LinkCard>
<LinkCard title="API Тинькофф (ReDoc)" href="https://tinkoff.github.io/api_asdk/"></LinkCard>
<LinkCard title="API Huntflow (RapiDoc)" href="https://api.huntflow.ru/v2/docs#overview"></LinkCard>

В нашем проекте мы используем бесплатный инструмент [`RapiDoc`](https://rapidocweb.com/). 
Его преимущества:
- быстрый старт, достаточно подгрузить корректный `json` со спецификацией;
- не требует рантайма, достаточно добавить несколько ссылок в статичный `html`;
- широкие возможности кастомизации макета;
- легко развернуть на хостинг, например, `Github Pages`.

### Документирование в RapiDoc

<Steps>
1. Конвертируй коллекции `Postman` в формат `OpenAPI` 
согласно [руководству](https://blog.postman.com/creating-an-openapi-definition-from-a-collection-with-the-postman-api/)
2. Создай локальный файл `apidocs.html` со следующим содержимым
    ```html
    <!doctype html>
    <html>
    <head>
        <meta charset="utf-8">
        <script 
            type="module" 
            src="https://unpkg.com/rapidoc/dist/rapidoc-min.js"
        ></script>
    </head>
    <body>
        <rapi-doc spec-url=""></rapi-doc>
    </body>
    </html>
    ```
3. Добавь относительный путь к файлу из шага 1 в качестве значения атрибута `spec-url` 
4. Теперь `apidocs.html` можно открыть в браузере
5. Если всё отображается корректно, размести документацию (`html` и `json`) на `Github Pages`
</Steps>

<Aside type="note" title="Зона роста">Если позволяет время, можно стилизовать страницу ориентируясь на примеры с официального сайта</Aside>

### Что еще почитать по теме

- [Советы по документированию REST API](https://appmaster.io/ru/blog/sovety-po-dokumentirovaniiu-restful-api)
- [Курс по документированию API](https://starkovden.github.io/)
